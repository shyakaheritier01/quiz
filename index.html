<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional CV Builder</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Global Styles */
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --text-light: #7f8c8d;
            --border-color: #ddd;
            --success-color: #27ae60;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f9f9f9;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 40px 0;
            text-align: center;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }
.btn:hover {
            background-color: red;
            transform: translateY(-2px);
        }
        .btn-secondary {
            display: inline-block;
            background-color: var(--light-color);
            color: var(--dark-color);
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background-color: #d5dbdb;
        }

        /* Features Section */
        .features {
            padding: 60px 0;
            text-align: center;
        }

        .features h2 {
            font-size: 2rem;
            margin-bottom: 40px;
            color: var(--dark-color);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .feature {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .feature:hover {
            transform: translateY(-10px);
        }

        .feature i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .feature h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        /* Footer */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 30px 0;
            text-align: center;
        }

        .footer-links {
            margin-bottom: 20px;
        }

        .footer-links a {
            color: white;
            margin: 0 15px;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--primary-color);
        }

        /* Builder Page Styles */
        .builder-container {
            padding: 40px 0;
        }

        #cv-form {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .form-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        .form-section:last-child {
            border-bottom: none;
        }

        .form-section h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"],
        .form-group input[type="month"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
            transition: border 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .entry {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            position: relative;
        }

        .remove-entry {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
            position: absolute;
            top: 10px;
            right: 10px;
            transition: background 0.3s ease;
        }

        .remove-entry:hover {
            background: #c0392b;
        }

        .form-actions {
            text-align: center;
            margin-top: 40px;
        }

        /* Preview Page Styles */
        .preview-container {
            padding: 40px 0;
        }

        .template-selector {
            text-align: center;
            margin-bottom: 30px;
        }

        .template-selector h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--dark-color);
        }

        .template-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .template-btn {
            padding: 10px 20px;
            background: var(--light-color);
            border: 2px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .template-btn:hover {
            background: #d5dbdb;
        }

        .template-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .cv-preview-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
        }

        .cv-preview {
            background: white;
            min-height: 800px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 40px;
        }

        .download-options {
            text-align: center;
        }

        .download-options h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--dark-color);
        }

        .download-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .download-buttons .btn {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Modern CV Template */
        .cv-preview.modern {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
        }

        .cv-preview.modern .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
        }

        .cv-preview.modern .name {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .cv-preview.modern .title {
            font-size: 1.2rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        .cv-preview.modern .contact-info {
            text-align: right;
        }

        .cv-preview.modern .contact-item {
            margin-bottom: 5px;
        }

        .cv-preview.modern .section {
            margin-bottom: 25px;
        }

        .cv-preview.modern .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 1px solid #eee;
        }

        .cv-preview.modern .summary {
            line-height: 1.7;
        }

        .cv-preview.modern .entry {
            margin-bottom: 20px;
        }

        .cv-preview.modern .entry-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .cv-preview.modern .entry-title {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .cv-preview.modern .entry-subtitle {
            font-style: italic;
            color: var(--text-light);
        }

        .cv-preview.modern .entry-date {
            color: var(--text-light);
        }

        .cv-preview.modern .entry-description {
            margin-top: 10px;
        }

        .cv-preview.modern .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .cv-preview.modern .skill {
            background: var(--light-color);
            padding: 5px 10px;
            border-radius: 3px;
        }

        .cv-preview.modern .languages-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .cv-preview.modern .language-item {
            display: flex;
            justify-content: space-between;
        }

        .cv-preview.modern .language-name {
            font-weight: 600;
        }

        .cv-preview.modern .language-proficiency {
            color: var(--text-light);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }
            
            header p {
                font-size: 1rem;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .form-row .form-group {
                margin-bottom: 20px;
            }
            
            .form-row .form-group:last-child {
                margin-bottom: 0;
            }
            
            .cv-preview {
                padding: 20px;
            }
            
            .download-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .download-buttons .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Page Transitions */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Home Page -->
    <div id="home-page" class="page active">
        <header>
            <div class="container">
                <h1>Build Your CV Online â€“ Fast, Free, and Easy</h1>
                <p>Create a professional resume in minutes and land your dream job</p>
                <button id="start-building" class="btn">Start Building My CV</button>
            </div>
        </header>

        <section class="features">
            <div class="container">
                <h2>Why Choose Our CV Builder?</h2>
                <div class="feature-grid">
                    <div class="feature">
                        <i class="fas fa-bolt"></i>
                        <h3>Quick & Easy</h3>
                        <p>Create a professional CV in just 10 minutes with our simple form.</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-palette"></i>
                        <h3>Beautiful Templates</h3>
                        <p>Choose from modern, classic, and simple designs.</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-file-download"></i>
                        <h3>Multiple Formats</h3>
                        <p>Download your CV as PDF, DOCX, or DOC.</p>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <div class="container">
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Use</a>
                    <a href="#">Contact Us</a>
                </div>
                <p>This website was created by Shyaka Heritier</p>
            </div>
        </footer>
    </div>

    <!-- Builder Page -->
    <div id="builder-page" class="page">
        <header>
            <div class="container">
                <h1>Build Your Professional CV</h1>
                <p>Fill in your details below</p>
            </div>
        </header>

        <main class="container builder-container">
            <form id="cv-form">
                <section class="form-section">
                    <h2><i class="fas fa-user"></i> Personal Information</h2>
                    <div class="form-group">
                        <label for="full-name">Full Name</label>
                        <input type="text" id="full-name" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input type="text" id="address">
                    </div>
                    <div class="form-group">
                        <label for="summary">Profile Summary / About Me</label>
                        <textarea id="summary" rows="4"></textarea>
                    </div>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-graduation-cap"></i> Education</h2>
                    <div id="education-entries">
                        <div class="entry education-entry">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Degree/Qualification</label>
                                    <input type="text" class="degree" required>
                                </div>
                                <div class="form-group">
                                    <label>Institution</label>
                                    <input type="text" class="institution" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Start Date</label>
                                    <input type="month" class="start-date">
                                </div>
                                <div class="form-group">
                                    <label>End Date (or expected)</label>
                                    <input type="month" class="end-date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea class="description" rows="2"></textarea>
                            </div>
                            <button type="button" class="remove-entry">Remove</button>
                        </div>
                    </div>
                    <button type="button" id="add-education" class="btn-secondary">+ Add Education</button>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-briefcase"></i> Work Experience</h2>
                    <div id="experience-entries">
                        <div class="entry experience-entry">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Job Title</label>
                                    <input type="text" class="job-title" required>
                                </div>
                                <div class="form-group">
                                    <label>Employer</label>
                                    <input type="text" class="employer" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Start Date</label>
                                    <input type="month" class="start-date">
                                </div>
                                <div class="form-group">
                                    <label>End Date (or present)</label>
                                    <input type="month" class="end-date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea class="description" rows="3"></textarea>
                            </div>
                            <button type="button" class="remove-entry">Remove</button>
                        </div>
                    </div>
                    <button type="button" id="add-experience" class="btn-secondary">+ Add Experience</button>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-star"></i> Skills</h2>
                    <div class="form-group">
                        <label>List your skills (comma separated)</label>
                        <textarea id="skills" rows="3" placeholder="e.g., Project Management, JavaScript, Public Speaking"></textarea>
                    </div>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-language"></i> Languages</h2>
                    <div id="language-entries">
                        <div class="entry language-entry">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Language</label>
                                    <input type="text" class="language" required>
                                </div>
                                <div class="form-group">
                                    <label>Proficiency</label>
                                    <select class="proficiency">
                                        <option value="Native">Native</option>
                                        <option value="Fluent">Fluent</option>
                                        <option value="Intermediate">Intermediate</option>
                                        <option value="Basic">Basic</option>
                                    </select>
                                </div>
                            </div>
                            <button type="button" class="remove-entry">Remove</button>
                        </div>
                    </div>
                    <button type="button" id="add-language" class="btn-secondary">+ Add Language</button>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-certificate"></i> Certifications (Optional)</h2>
                    <div id="certification-entries">
                        <div class="entry certification-entry">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Certification Name</label>
                                    <input type="text" class="certification-name">
                                </div>
                                <div class="form-group">
                                    <label>Issuing Organization</label>
                                    <input type="text" class="issuing-org">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Date Earned</label>
                                    <input type="month" class="date-earned">
                                </div>
                            </div>
                            <button type="button" class="remove-entry">Remove</button>
                        </div>
                    </div>
                    <button type="button" id="add-certification" class="btn-secondary">+ Add Certification</button>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-heart"></i> Hobbies & Interests (Optional)</h2>
                    <div class="form-group">
                        <textarea id="hobbies" rows="2" placeholder="e.g., Photography, Hiking, Chess"></textarea>
                    </div>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-users"></i> References (Optional)</h2>
                    <div class="form-group">
                        <textarea id="references" rows="4" placeholder="Include name, position, company, and contact information"></textarea>
                    </div>
                </section>

                <div class="form-actions">
                    <button type="submit" class="btn">Preview My CV</button>
                </div>
            </form>
        </main>

        <footer>
            <div class="container">
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Use</a>
                    <a href="#">Contact Us</a>
                </div>
                <p>This website was created by Shyaka Heritier</p>
            </div>
        </footer>
    </div>

    <!-- Preview Page -->
    <div id="preview-page" class="page">
        <header>
            <div class="container">
                <h1>Your Professional CV</h1>
                <p>Preview and download your CV</p>
            </div>
        </header>

        <main class="container preview-container">
            <div class="template-selector">
                <h2>Choose a Template</h2>
                <div class="template-options">
                    <button class="template-btn active" data-template="modern">Modern</button>
                    <button class="template-btn" data-template="classic">Classic</button>
                    <button class="template-btn" data-template="simple">Simple</button>
                </div>
            </div>

            <div class="cv-preview-container">
                <div id="cv-preview" class="cv-preview modern">
                    <!-- CV content will be inserted here by JavaScript -->
                </div>
            </div>

            <div class="download-options">
                <h2>Download Your CV</h2>
                <div class="download-buttons">
                    <button id="download-pdf" class="btn"><i class="fas fa-file-pdf"></i> Download PDF</button>
                    <button id="download-docx" class="btn"><i class="fas fa-file-word"></i> Download DOCX</button>
                    <button id="download-doc" class="btn"><i class="fas fa-file-alt"></i> Download DOC</button>
                </div>
                <button id="edit-cv" class="btn-secondary"><i class="fas fa-edit"></i> Edit CV</button>
            </div>
        </main>

        <footer>
            <div class="container">
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Use</a>
                    <a href="#">Contact Us</a>
                </div>
                <p>This website was created by Shyaka Heritier</p>
            </div>
        </footer>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    
    <script>
        // Page Navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Show home page by default
            showPage('home-page');
            
            // Navigation buttons
            document.getElementById('start-building').addEventListener('click', function() {
                showPage('builder-page');
            });
            
            document.getElementById('edit-cv').addEventListener('click', function() {
                showPage('builder-page');
            });
            
            // Form submission to preview
            document.getElementById('cv-form').addEventListener('submit', function(e) {
                e.preventDefault();
                collectFormData();
                showPage('preview-page');
                renderCV('modern');
            });
        });
        
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
        }
        
        // Builder Page Logic
        document.addEventListener('DOMContentLoaded', function() {
            // Add education entry
            document.getElementById('add-education').addEventListener('click', function() {
                const educationEntries = document.getElementById('education-entries');
                const newEntry = document.querySelector('.education-entry').cloneNode(true);
                
                // Clear input values in the new entry
                const inputs = newEntry.querySelectorAll('input, textarea');
                inputs.forEach(input => {
                    input.value = '';
                });
                
                educationEntries.appendChild(newEntry);
            });

            // Add experience entry
            document.getElementById('add-experience').addEventListener('click', function() {
                const experienceEntries = document.getElementById('experience-entries');
                const newEntry = document.querySelector('.experience-entry').cloneNode(true);
                
                // Clear input values in the new entry
                const inputs = newEntry.querySelectorAll('input, textarea');
                inputs.forEach(input => {
                    input.value = '';
                });
                
                experienceEntries.appendChild(newEntry);
            });

            // Add language entry
            document.getElementById('add-language').addEventListener('click', function() {
                const languageEntries = document.getElementById('language-entries');
                const newEntry = document.querySelector('.language-entry').cloneNode(true);
                
                // Clear input values in the new entry
                const inputs = newEntry.querySelectorAll('input, select');
                inputs.forEach(input => {
                    if (input.tagName === 'SELECT') {
                        input.selectedIndex = 0;
                    } else {
                        input.value = '';
                    }
                });
                
                languageEntries.appendChild(newEntry);
            });

            // Add certification entry
            document.getElementById('add-certification').addEventListener('click', function() {
                const certificationEntries = document.getElementById('certification-entries');
                const newEntry = document.querySelector('.certification-entry').cloneNode(true);
                
                // Clear input values in the new entry
                const inputs = newEntry.querySelectorAll('input');
                inputs.forEach(input => {
                    input.value = '';
                });
                
                certificationEntries.appendChild(newEntry);
            });

            // Remove entry
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('remove-entry')) {
                    const entry = e.target.closest('.entry');
                    // Don't remove the last entry of each type
                    if (entry.parentElement.children.length > 1) {
                        entry.remove();
                    } else {
                        alert('You need to have at least one entry for this section.');
                    }
                }
            });
        });
        
        // Collect form data
        function collectFormData() {
            const formData = {
                personal: {
                    name: document.getElementById('full-name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    address: document.getElementById('address').value,
                    summary: document.getElementById('summary').value
                },
                education: [],
                experience: [],
                skills: document.getElementById('skills').value,
                languages: [],
                certifications: [],
                hobbies: document.getElementById('hobbies').value,
                references: document.getElementById('references').value
            };

            // Collect education entries
            document.querySelectorAll('.education-entry').forEach(entry => {
                formData.education.push({
                    degree: entry.querySelector('.degree').value,
                    institution: entry.querySelector('.institution').value,
                    startDate: entry.querySelector('.start-date').value,
                    endDate: entry.querySelector('.end-date').value,
                    description: entry.querySelector('.description').value
                });
            });

            // Collect experience entries
            document.querySelectorAll('.experience-entry').forEach(entry => {
                formData.experience.push({
                    jobTitle: entry.querySelector('.job-title').value,
                    employer: entry.querySelector('.employer').value,
                    startDate: entry.querySelector('.start-date').value,
                    endDate: entry.querySelector('.end-date').value,
                    description: entry.querySelector('.description').value
                });
            });

            // Collect language entries
            document.querySelectorAll('.language-entry').forEach(entry => {
                formData.languages.push({
                    language: entry.querySelector('.language').value,
                    proficiency: entry.querySelector('.proficiency').value
                });
            });

            // Collect certification entries
            document.querySelectorAll('.certification-entry').forEach(entry => {
                formData.certifications.push({
                    name: entry.querySelector('.certification-name').value,
                    organization: entry.querySelector('.issuing-org').value,
                    date: entry.querySelector('.date-earned').value
                });
            });

            // Store form data in sessionStorage
            sessionStorage.setItem('cvData', JSON.stringify(formData));
        }
        
        // Preview Page Logic
        document.addEventListener('DOMContentLoaded', function() {
            // Template selection
            const templateButtons = document.querySelectorAll('.template-btn');
            const cvPreview = document.getElementById('cv-preview');
            
            templateButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const template = this.dataset.template;
                    renderCV(template);
                    
                    // Update active button
                    templateButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Download as PDF
            document.getElementById('download-pdf').addEventListener('click', function() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Use html2canvas to capture the CV as an image
                html2canvas(cvPreview).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const cvData = JSON.parse(sessionStorage.getItem('cvData'));
                    doc.addImage(imgData, 'PNG', 10, 10, 190, 0);
                    doc.save(`${cvData.personal.name.replace(' ', '_')}_CV.pdf`);
                });
            });

            // Download as DOCX
            document.getElementById('download-docx').addEventListener('click', function() {
                const { Document, Paragraph, TextRun, Packer } = window.docx;
                const cvData = JSON.parse(sessionStorage.getItem('cvData'));
                
                // Create a new document
                const doc = new Document();
                
                // Add content to the document
                const content = [];
                
                // Add personal information
                content.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: cvData.personal.name,
                                bold: true,
                                size: 28
                            })
                        ],
                        spacing: {
                            after: 200
                        }
                    })
                );
                
                // Add contact information
                const contactInfo = [];
                if (cvData.personal.email) contactInfo.push(cvData.personal.email);
                if (cvData.personal.phone) contactInfo.push(cvData.personal.phone);
                if (cvData.personal.address) contactInfo.push(cvData.personal.address);
                
                content.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: contactInfo.join(' | '),
                                size: 22
                            })
                        ],
                        spacing: {
                            after: 200
                        }
                    })
                );
                
                // Add summary
                if (cvData.personal.summary) {
                    content.push(
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "PROFILE SUMMARY",
                                    bold: true,
                                    size: 22,
                                    underline: {}
                                })
                            ],
                            spacing: {
                                after: 100
                            }
                        }),
                        new Paragraph({
                            text: cvData.personal.summary,
                            spacing: {
                                after: 200
                            }
                        })
                    );
                }
                
                // Add education
                if (cvData.education.length > 0) {
                    content.push(
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "EDUCATION",
                                    bold: true,
                                    size: 22,
                                    underline: {}
                                })
                            ],
                            spacing: {
                                after: 100
                            }
                        })
                    );
                    
                    cvData.education.forEach(edu => {
                        content.push(
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: `${edu.degree} at ${edu.institution}`,
                                        bold: true
                                    })
                                ]
                            }),
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: `${formatDate(edu.startDate)} - ${formatDate(edu.endDate)}`,
                                        italics: true
                                    })
                                ]
                            }),
                            new Paragraph({
                                text: edu.description || '',
                                spacing: {
                                    after: 100
                                }
                            })
                        );
                    });
                }
                
                // Add work experience
                if (cvData.experience.length > 0) {
                    content.push(
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "WORK EXPERIENCE",
                                    bold: true,
                                    size: 22,
                                    underline: {}
                                })
                            ],
                            spacing: {
                                after: 100
                            }
                        })
                    );
                    
                    cvData.experience.forEach(exp => {
                        content.push(
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: `${exp.jobTitle} at ${exp.employer}`,
                                        bold: true
                                    })
                                ]
                            }),
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: `${formatDate(exp.startDate)} - ${formatDate(exp.endDate)}`,
                                        italics: true
                                    })
                                ]
                            }),
                            new Paragraph({
                                text: exp.description || '',
                                spacing: {
                                    after: 100
                                }
                            })
                        );
                    });
                }
                
                // Add sections for skills, languages, etc. (similar structure)
                
                // Build the document
                doc.addSection({
                    children: content
                });
                
                // Generate and download the DOCX file
                Packer.toBlob(doc).then(blob => {
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `${cvData.personal.name.replace(' ', '_')}_CV.docx`;
                    link.click();
                });
            });

            // Download as DOC (simplified version of DOCX)
            document.getElementById('download-doc').addEventListener('click', function() {
                alert('DOC download functionality would be implemented similarly to DOCX but with simpler formatting.');
            });
        });
        
        // Render the CV based on the template
        function renderCV(template) {
            const cvData = JSON.parse(sessionStorage.getItem('cvData'));
            const cvPreview = document.getElementById('cv-preview');
            
            // Clear existing classes and add the template class
            cvPreview.className = 'cv-preview';
            cvPreview.classList.add(template);
            
            let cvHTML = '';
            
            if (template === 'modern') {
                cvHTML = `
                    <div class="header">
                        <div class="name-title">
                            <h1 class="name">${cvData.personal.name}</h1>
                            <p class="title">Professional Profile</p>
                        </div>
                        <div class="contact-info">
                            <p class="contact-item">${cvData.personal.email}</p>
                            <p class="contact-item">${cvData.personal.phone}</p>
                            <p class="contact-item">${cvData.personal.address}</p>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">Profile Summary</h2>
                        <p class="summary">${cvData.personal.summary}</p>
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">Education</h2>
                        ${cvData.education.map(edu => `
                            <div class="entry">
                                <div class="entry-header">
                                    <div>
                                        <span class="entry-title">${edu.degree}</span>
                                        <span class="entry-subtitle">${edu.institution}</span>
                                    </div>
                                    <div class="entry-date">
                                        ${formatDate(edu.startDate)} - ${formatDate(edu.endDate)}
                                    </div>
                                </div>
                                <p class="entry-description">${edu.description}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">Work Experience</h2>
                        ${cvData.experience.map(exp => `
                            <div class="entry">
                                <div class="entry-header">
                                    <div>
                                        <span class="entry-title">${exp.jobTitle}</span>
                                        <span class="entry-subtitle">${exp.employer}</span>
                                    </div>
                                    <div class="entry-date">
                                        ${formatDate(exp.startDate)} - ${formatDate(exp.endDate)}
                                    </div>
                                </div>
                                <p class="entry-description">${exp.description}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">Skills</h2>
                        <div class="skills-list">
                            ${cvData.skills.split(',').map(skill => `
                                <span class="skill">${skill.trim()}</span>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">Languages</h2>
                        <div class="languages-list">
                            ${cvData.languages.map(lang => `
                                <div class="language-item">
                                    <span class="language-name">${lang.language}</span>
                                    <span class="language-proficiency">${lang.proficiency}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    ${cvData.certifications.length > 0 ? `
                    <div class="section">
                        <h2 class="section-title">Certifications</h2>
                        ${cvData.certifications.map(cert => `
                            <div class="entry">
                                <div class="entry-header">
                                    <div>
                                        <span class="entry-title">${cert.name}</span>
                                        <span class="entry-subtitle">${cert.organization}</span>
                                    </div>
                                    <div class="entry-date">
                                        ${formatDate(cert.date)}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    ` : ''}
                    
                    ${cvData.hobbies ? `
                    <div class="section">
                        <h2 class="section-title">Hobbies & Interests</h2>
                        <p>${cvData.hobbies}</p>
                    </div>
                    ` : ''}
                    
                    ${cvData.references ? `
                    <div class="section">
                        <h2 class="section-title">References</h2>
                        <p>${cvData.references}</p>
                    </div>
                    ` : ''}
                `;
            } else if (template === 'classic') {
                // Classic template rendering (similar structure with different styling)
                cvHTML = `
                    <div class="header">
                        <h1 class="name">${cvData.personal.name}</h1>
                        <div class="contact-info">
                            <p>${cvData.personal.email} | ${cvData.personal.phone} | ${cvData.personal.address}</p>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">PROFILE</h2>
                        <p>${cvData.personal.summary}</p>
                    </div>
                    
                    <div class="section">
                        <h2 class="section-title">EDUCATION</h2>
                        ${cvData.education.map(edu => `
                            <div class="entry">
                                <h3>${edu.degree}</h3>
                                <p>${edu.institution} | ${formatDate(edu.startDate)} - ${formatDate(edu.endDate)}</p>
                                <p>${edu.description}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <!-- Other sections similar to modern template -->
                `;
            } else {
                // Simple template rendering
                cvHTML = `
                    <div class="header">
                        <h1>${cvData.personal.name}</h1>
                        <p>${cvData.personal.email} | ${cvData.personal.phone} | ${cvData.personal.address}</p>
                    </div>
                    
                    <div class="section">
                        <h2>Summary</h2>
                        <p>${cvData.personal.summary}</p>
                    </div>
                    
                    <div class="section">
                        <h2>Education</h2>
                        ${cvData.education.map(edu => `
                            <div class="entry">
                                <p><strong>${edu.degree}</strong> - ${edu.institution} (${formatDate(edu.startDate)} - ${formatDate(edu.endDate)})</p>
                                <p>${edu.description}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <!-- Other sections similar to modern template -->
                `;
            }
            
            cvPreview.innerHTML = cvHTML;
        }

        // Format date from YYYY-MM to Month YYYY
        function formatDate(dateString) {
            if (!dateString) return 'Present';
            
            const date = new Date(dateString);
            const options = { year: 'numeric', month: 'long' };
            return date.toLocaleDateString('en-US', options);
        }
    </script>
</body>
</html>
